## 数据是怎么存的

* InnoDB将数据划分为若干个页，以页作为磁盘和内存之间交互的基本单位

* 页的大小一般为 16 KB。也就是在一般情况下，一次最少从磁盘中读取16KB的内容到内存中，一次最少把内存中的16KB内容刷新到磁盘中

* InnoDB存储引擎有4种不同类型的行格式，分别是Compact、Redundant、Dynamic和Compressed行格式

* 一条完整的记录其实可以被分为记录的额外信息和记录的真实数据两大部分

* 额外信息分为3类，分别是变长字段长度列表、NULL值列表和记录头信息

* 【头信息】delete_mask 标记该记录是否被删除

* 【头信息】n_owned 表示当前记录拥有的记录数【关系到页中的槽】

* 【头信息】next_record 表示下一条记录的相对位置

* 【真实数据】InnoDB存储引擎会为每条记录都添加 transaction_id 和 roll_pointer 这两个列【关系到事务】

* InnoDB会自动给每个页里边儿加了两个记录，由于这两个记录并不是我们自己插入的，所以有时候也称为伪记录或者虚拟记录。这两个伪记录一个代表最小记录，一个代表最大记录

* 规定 Infimum记录（也就是最小记录） 的下一条记录就是本页中主键值最小的用户记录，而本页中主键值最大的用户记录的下一条记录就是 Supremum记录（也就是最大记录）

* InnoDB会把页中的记录划分为若干个组，每个组的最后一个记录的地址偏移量作为一个槽，存放在Page Directory中

* 每个组的最后一条记录（也就是组内最大的那条记录）的头信息中的n_owned属性表示该记录拥有多少条记录，也就是该组内共有几条记录

* 通过二分法确定该记录所在的槽，通过记录的next_record属性遍历该槽所在的组中的各个记录

* 各个数据页可以组成一个双向链表，而每个数据页中的记录会按照主键值从小到大的顺序组成一个单向链表

